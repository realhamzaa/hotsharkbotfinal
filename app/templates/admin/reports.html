{% extends "base.html" %}

{% block title %}Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± - HOT SHARK Admin{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="text-white mb-4">
            <i class="fas fa-file-alt"></i>
            Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        </h1>
    </div>
</div>

<!-- Reports Overview -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-bar"></i>
                    Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3">
                        <div class="text-center">
                            <i class="fas fa-file-alt fa-3x text-primary mb-2"></i>
                            <h4>{{ reports|length }}</h4>
                            <p class="text-muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i class="fas fa-calendar-day fa-3x text-success mb-2"></i>
                            <h4>{{ reports|selectattr('report_type', 'equalto', 'daily')|list|length }}</h4>
                            <p class="text-muted">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i class="fas fa-calendar-week fa-3x text-warning mb-2"></i>
                            <h4>{{ reports|selectattr('report_type', 'equalto', 'weekly')|list|length }}</h4>
                            <p class="text-muted">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <i class="fas fa-calendar-alt fa-3x text-info mb-2"></i>
                            <h4>{{ reports|selectattr('report_type', 'equalto', 'monthly')|list|length }}</h4>
                            <p class="text-muted">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Generate Reports -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-plus"></i>
                    Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø¬Ø¯ÙŠØ¯
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <button class="btn btn-success w-100 mb-3" onclick="generateReport('daily')">
                            <i class="fas fa-calendar-day"></i>
                            ØªÙ‚Ø±ÙŠØ± ÙŠÙˆÙ…ÙŠ
                        </button>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-warning w-100 mb-3" onclick="generateReport('weekly')">
                            <i class="fas fa-calendar-week"></i>
                            ØªÙ‚Ø±ÙŠØ± Ø£Ø³Ø¨ÙˆØ¹ÙŠ
                        </button>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-info w-100 mb-3" onclick="generateReport('monthly')">
                            <i class="fas fa-calendar-alt"></i>
                            ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø±ÙŠ
                        </button>
                    </div>
                </div>
                
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ ÙŠÙˆÙ… Ø³Ø¨Øª ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© 12:00 Ø¸Ù‡Ø±Ø§Ù‹ Ø¨ØªÙˆÙ‚ÙŠØª ØºØ±ÙŠÙ†ØªØ´.
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Reports -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-history"></i>
                    Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø®ÙŠØ±Ø©
                </h5>
            </div>
            <div class="card-body">
                {% if reports %}
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ø¹Ø±Ù</th>
                                <th>Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</th>
                                <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                <th>Ø§Ù„ÙØªØ±Ø©</th>
                                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for report in reports %}
                            <tr>
                                <td><strong>#{{ report.id }}</strong></td>
                                <td>
                                    <span class="badge 
                                        {% if report.report_type == 'daily' %}bg-success
                                        {% elif report.report_type == 'weekly' %}bg-warning
                                        {% else %}bg-info{% endif %}">
                                        {% if report.report_type == 'daily' %}ğŸ“… ÙŠÙˆÙ…ÙŠ
                                        {% elif report.report_type == 'weekly' %}ğŸ“Š Ø£Ø³Ø¨ÙˆØ¹ÙŠ
                                        {% else %}ğŸ“ˆ Ø´Ù‡Ø±ÙŠ{% endif %}
                                    </span>
                                </td>
                                <td>
                                    {% if report.user_id %}
                                    <span class="badge bg-primary">{{ report.user_id }}</span>
                                    {% else %}
                                    <span class="badge bg-secondary">Ø¹Ø§Ù…</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {{ report.start_date.strftime('%Y-%m-%d') }} - 
                                    {{ report.end_date.strftime('%Y-%m-%d') }}
                                </td>
                                <td>{{ report.generated_at.strftime('%Y-%m-%d %H:%M') }}</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="viewReport({{ report.id }})">
                                        <i class="fas fa-eye"></i> Ø¹Ø±Ø¶
                                    </button>
                                    <button class="btn btn-secondary btn-sm" onclick="downloadReport({{ report.id }})">
                                        <i class="fas fa-download"></i> ØªØ­Ù…ÙŠÙ„
                                    </button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="text-center py-5">
                    <i class="fas fa-file-alt fa-3x text-muted mb-3"></i>
                    <h5 class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚Ø§Ø±ÙŠØ± Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</h5>
                    <p class="text-muted">Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙˆÙ„ ØªÙ‚Ø±ÙŠØ± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ø¹Ù„Ø§Ù‡</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Performance Metrics -->
<div class="row mt-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-pie"></i>
                    Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
                </h5>
            </div>
            <div class="card-body">
                <canvas id="performanceChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-line"></i>
                    Ù†Ù…Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                </h5>
            </div>
            <div class="card-body">
                <canvas id="growthChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
function generateReport(type) {
    if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± ' + type + ' Ø¬Ø¯ÙŠØ¯ØŸ')) {
        // In a real implementation, this would make an API call
        alert('Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ' + type + ' Ù‚Ø±ÙŠØ¨Ø§Ù‹...');
        
        // You can implement the actual report generation logic here
        // fetch('/admin/reports/generate', {
        //     method: 'POST',
        //     headers: {'Content-Type': 'application/json'},
        //     body: JSON.stringify({type: type})
        // }).then(() => location.reload());
    }
}

function viewReport(reportId) {
    // In a real implementation, this would open the report in a modal or new page
    alert('Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± #' + reportId);
}

function downloadReport(reportId) {
    // In a real implementation, this would download the report as PDF
    alert('ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± #' + reportId);
}

// Performance Chart
const performanceCtx = document.getElementById('performanceChart').getContext('2d');
new Chart(performanceCtx, {
    type: 'doughnut',
    data: {
        labels: ['ØªÙˆØµÙŠØ§Øª Ù†Ø§Ø¬Ø­Ø©', 'ØªÙˆØµÙŠØ§Øª Ø®Ø§Ø³Ø±Ø©', 'ØªÙˆØµÙŠØ§Øª Ù†Ø´Ø·Ø©'],
        datasets: [{
            data: [65, 25, 10],
            backgroundColor: ['#28a745', '#dc3545', '#007bff'],
            borderWidth: 0
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: {
                position: 'bottom'
            }
        }
    }
});

// Growth Chart
const growthCtx = document.getElementById('growthChart').getContext('2d');
new Chart(growthCtx, {
    type: 'line',
    data: {
        labels: ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ'],
        datasets: [{
            label: 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯',
            data: [12, 19, 25, 32, 45, 58],
            borderColor: '#007bff',
            backgroundColor: 'rgba(0, 123, 255, 0.1)',
            tension: 0.4,
            fill: true
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: {
                beginAtZero: true
            }
        },
        plugins: {
            legend: {
                display: false
            }
        }
    }
});

// Auto-refresh every 2 minutes
setTimeout(function() {
    location.reload();
}, 120000);
</script>
{% endblock %}

